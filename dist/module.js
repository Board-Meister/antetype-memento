function f({modules:n,canvas:i}){let a=[],o=[],c=e=>{if(!(e.target!==i||!e.ctrlKey)){if(e.key==="z"){m();return}if(e.key==="y"){I();return}}},s=e=>{let t=[];return e.forEach(r=>{t.push({instance:r,original:n.core.clone.getOriginal(r.layer)})}),t},d=e=>{a.push(s(e)),o=[],a.length>100&&a.shift()},m=async()=>{if(a.length===0)return;let e=a.splice(-1)[0];o.push(e),await n.core.view.recalculate();for(let t of e)await t.instance.undo(t.original,t.instance.data??void 0);n.core.view.redraw()},I=async()=>{if(o.length===0)return;let e=o.splice(-1)[0];a.push(e),await n.core.view.recalculate();for(let t of e)await t.instance.redo(t.original,t.instance.data??void 0);n.core.view.redraw()};return document.addEventListener("keyup",c,!1),{addToStack:d}}export{f as default};
